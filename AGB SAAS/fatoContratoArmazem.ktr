<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>fatoContratoArmazem</name>
    <description />
    <extended_description />
    <trans_version />
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection>SQL Server</connection>
        <schema />
        <table>dimArquivoTransformacao</table>
        <size_limit_lines />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject />
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject />
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject />
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject />
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject />
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection />
        <schema />
        <table />
        <interval />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection />
        <schema />
        <table />
        <timeout_days />
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection />
      <table />
      <field />
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file />
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2015/09/02 16:35:08.215</created_date>
    <modified_user>-</modified_user>
    <modified_date>2015/09/02 16:35:08.215</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>Oracle</name>
    <server />
    <type>ORACLE</type>
    <access>Native</access>
    <database>(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.2.240)(PORT=1521)))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=orcln)))</database>
    <port>-1</port>
    <username>NATIVAPTM </username>
    <password>Encrypted 2be98afc86aa7f289aa0aba75cc99aac3</password>
    <servername />
    <data_tablespace />
    <index_tablespace />
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>-1</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>alter session set "_optimizer_join_elimination_enabled"=false;
alter SESSION set NLS_DATE_FORMAT = 'DD/MM/YYYY'; </attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>SQL Server</name>
    <server>anywhere.siagribi.com.br</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>DW_NATIVA</database>
    <port>52731</port>
    <username>siagribi_extrator</username>
    <password>Encrypted 2be98afc86aa7ca93a20b864388c7ecfa</password>
    <servername />
    <data_tablespace>AHL2108</data_tablespace>
    <index_tablespace>AHL2108</index_tablespace>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>52731</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>GET DATA DW</from>
      <to>Select values DW</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>GET DATA ERP</from>
      <to>Select values ERP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values DW</from>
      <to>Sort rows DW</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values ERP</from>
      <to>Sort rows ERP</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows DW</from>
      <to>Merge Rows (diff)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Sort rows ERP</from>
      <to>Merge Rows (diff)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Merge Rows (diff)</from>
      <to>Synchronize after merge</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>GET DATA DW</name>
    <type>TableInput</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>SQL Server</connection>
    <sql>SELECT EMPRESA
	, CONTRATO
	, CONTRATOORIGINAL
	, PARCEIRO
	, "DATA"
	, PRODUTO
	, CULTURA
	, CICLO
	, QUANTIDADE
 	, TIPO
	, PRECOSACA
	, TIPOMOEDA
	, MUNICIPIO
	, MOEDA
	, COTACAOCONTRATO
	, NEGOCIACAOTROCAS
	, MARGEMLUCROBASE
	, MARGEMLUCROALTERADA
	, MARGEMLUCROPONDERADA
	, POSICAO
	, QUANTIDADESACA
	, VALORBRUTO
	, VALOR
	, FUNRURAL
	, ULTIMOVENCIMENTO
	, QTDENTREGUE
	, QTDENTREGAR
	, QTDENTREGUENF
	, DATAPRIMEIRANF
	, DATAULTIMANF
	, VALORDESPESA
	, DESCONTODESPESA
    , VALORENTREGUENOTAFISCAL
	, SITUACAO
	, TIPOFRETE
	, CIFFOB
	, RT
	, VENDEDOR
	, QTDEOUTRASBAIXAS
	, REPRESENTANTECOMERCIAL
    , FATORCONVERSAOCULTURA
	, PROPRIEDADE
FROM fatoContratoArmazem
ORDER BY  "DATA", CONTRATO, PARCEIRO, CICLO, PRODUTO </sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>GET DATA ERP</name>
    <type>TableInput</type>
    <description>Reads information from table [TABDESC] on database [Oracle]</description>
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>Oracle</connection>
    <sql>SELECT C.CODI_EMP EMPRESA
	, C.NUME_CCP CONTRATO
	, C.CONO_CCP CONTRATOORIGINAL
	, C.CODI_TRA PARCEIRO
	, C.DATA_CCP DATA
	, C.CODI_PSV PRODUTO
	, culpsv.codi_CUL CULTURA
	, C.CODI_CIC CICLO
	, C.QTDE_CCP QUANTIDADE
 	, C.CODI_TIC TIPO
	, coalesce(C.VLOR_CCP, 0) as PRECOSACA
	, coalesce(case when C.CODI_IND is null then 'R$' else I.ABRE_IND end, I.ABRE_IND) as TIPOMOEDA
	, coalesce(case when C.PROP_PRO is not null then PD.CODI_MUN else TR.CODI_MUN end, -1) as MUNICIPIO
	, COALESCE(C.CODI_IND,-1) MOEDA
	, COALESCE(IND.VLOR_VLR, 1) COTACAOCONTRATO
	, C.CTRL_NEG NEGOCIACAOTROCAS
	, NEG.MBAS_NEG MARGEMLUCROBASE
	, NEG.MALT_NEG MARGEMLUCROALTERADA
	, (NEG.MALT_NEG*C.QTUN_CCP) MARGEMLUCROPONDERADA
	--, C.DTPS_CCP POSICAO		
	, CASE WHEN (EXTRACT(YEAR FROM C.DTPS_CCP) &lt; 1753) THEN (SELECT TO_DATE (SYSDATE) FROM dual) ELSE (C.DTPS_CCP) END POSICAO --Critério adicionado pelo Leonildo para evitar erros no momento de extração e a atualização ficar parada para o cliente #Houve casos de erro de digitação para essa data onde o ano ficou como "0202", logo ocorre erro no Pentaho.
	--C.QTUN_CCP QUANTIDADESACA
	-- #Ajuste Pedro Menegat 27/12/2021 | Substituindo denominador = 0 para corrigir erro de processamento (cálculo com divisão por zero no analysis)
	, CASE WHEN COALESCE(C.QTUN_CCP,0) = 0 THEN 0.001 ELSE C.QTUN_CCP END QUANTIDADESACA
	, C.TOTA_CCP VALORBRUTO
	, C.VLIQ_CCP VALOR
	, C.IFUN_CCP FUNRURAL
	, (SELECT MAX(P.VENC_COP) FROM ctrcomprapar P WHERE P.NUME_CCP = C.nume_ccp) ULTIMOVENCIMENTO
	--#Ajuste Leonildo 18/11/2021 | Comentado linha de calculo de "QTDENTREGUE" e substituido pelo saldo entregue oriundo da View "VSALDO_CONTRATO"
	--, COALESCE((SELECT SUM(MC.QTDE_MCO* CASE WHEN T.TIPO_TIC = R1.TIPO_ROM THEN 1 ELSE -1 END) FROM MOVCONTRATO MC INNER JOIN ROMANEIO R1 ON MC.CODI_EMP = R1.CODI_EMP AND MC.nurt_mco = R1.nume_rom WHERE  MC.NUME_CCP = C.NUME_CCP AND R1.situ_rom&lt;&gt; '9'),0) QTDENTREGUE
	--, COALESCE((SELECT SUM(MC.QTDE_MCO * CASE WHEN T.TIPO_TIC = R1.TIPO_ROM THEN 1 ELSE -1 END) FROM MOVCONTRATO MC INNER JOIN ROMANEIO R1 ON MC.CODI_EMP = R1.CODI_EMP AND MC.nurt_mco = R1.nume_rom WHERE  MC.NUME_CCP = C.NUME_CCP AND R1.situ_rom&lt;&gt; '9' AND MC.TIPO_MCO = 'R') + (SELECT SUM(MC2.QTDE_MCO * CASE WHEN C.CODI_TRA = T2.CLIC_TRS THEN 1 ELSE -1 END) FROM MOVCONTRATO MC2 INNER JOIN transf T2 ON MC2.CODI_EMP = T2.CODI_EMP AND MC2.nurt_mco = T2.NUME_TRS WHERE  MC2.NUME_CCP = C.NUME_CCP AND T2.SITU_TRS &lt;&gt; '9' AND MC2.TIPO_MCO = 'T'),0) QTDENTREGUE
	, COALESCE((SELECT CASE WHEN (COALESCE(VSALDO_CONTRATO.TIPO_TIC, '') = 'S') THEN (((QTDE_ROE - QTDE_ROS) + (QTDE_TRC - QTDE_TRD)) * -1) ELSE ((QTDE_ROE - QTDE_ROS) + (QTDE_TRC - QTDE_TRD)) END FROM VSALDO_CONTRATO WHERE VSALDO_CONTRATO.CODI_EMP = C.CODI_EMP AND VSALDO_CONTRATO.NUME_CCP = C.NUME_CCP), 0) QTDENTREGUE
	--#Ajuste Leonildo 17/11/2021 | Comentado linha de calculo de "QTDENTREGAR" e substituido por outro calculo, pegando o saldo entregue calculado/ajustado na linha acima
	--, (C.QTDE_CCP-(COALESCE((SELECT SUM(MC.QTDE_MCO) FROM MOVCONTRATO MC INNER JOIN ROMANEIO R1 ON MC.CODI_EMP = R1.CODI_EMP AND MC.nurt_mco = R1.nume_rom WHERE MC.NUME_CCP = C.NUME_CCP AND R1.situ_rom&lt;&gt; '9'),0))) QTDENTREGAR
	, COALESCE((SELECT VSALDO_CONTRATO.QTDE_SLD FROM VSALDO_CONTRATO WHERE VSALDO_CONTRATO.CODI_EMP = C.CODI_EMP AND VSALDO_CONTRATO.NUME_CCP = C.NUME_CCP), 0) QTDENTREGAR
	, (SELECT SUM(QTDE_ITEM) FROM NOTAS_CONTRATO WHERE NUME_CCP = C.NUME_CCP) QTDENTREGUENF
	, (SELECT MIN(demi_doc) FROM NOTAS_CONTRATO WHERE NUME_CCP = C.NUME_CCP) DATAPRIMEIRANF
	, (SELECT MAX(demi_doc) FROM NOTAS_CONTRATO WHERE NUME_CCP = C.NUME_CCP) DATAULTIMANF
	, (select sum(vlor_dar) from desparmazcab cab inner join desparmaz da on cab.codi_dac = da.codi_dac and cab.codi_emp = da.codi_emp where cab.nume_ccp = c.nume_ccp) VALORDESPESA
	, (select sum(DECR_dar) from desparmazcab cab inner join desparmaz da on cab.codi_dac = da.codi_dac and cab.codi_emp = da.codi_emp where cab.nume_ccp = c.nume_ccp) DESCONTODESPESA
	--FINANCEIRO NOTAS DO CONTRATO
    , (COALESCE((SELECT SUM(I.QTDE_INO) FROM CTRCOMPRA C1 
					INNER JOIN NOTAORIG NOR ON C1.CODI_EMP = NOR.CODI_EMP AND C1.codi_tra = NOR.TRAO_NFR AND C1.NUME_CCP = NOR.noto_nfr AND NOR.TIPO_NFR = 'CV' 
					INNER JOIN NOTA N ON NOR.NOTD_NFR = N.NPRE_NOT AND NOR.TIPD_NFR = 'NE' 
					INNER JOIN INOTA I ON N.NPRE_NOT = I.NPRE_NOT WHERE C1.NUME_CCP = C.NUME_CCP), 0) 
						+
				--FINANCEIRO NOTAS DA EMPRESA VINCULADAS
		COALESCE((SELECT SUM(CASE WHEN COALESCE(NCPZ_CFO , 'S') = 'N' AND COMP_CFO IN('2','3') THEN null ELSE (i.qtde_ino)  END) FROM CTRCOMPRA   C1
					INNER JOIN NOTAORIG NOR ON C1.CODI_EMP = NOR.CODI_EMP AND C1.codi_tra = NOR.TRAO_NFR AND C1.NUME_CCP = NOR.noto_nfr AND NOR.TIPO_NFR = 'CV'
	                INNER JOIN NOTAORIG NOR2 ON NOR.notd_nfr = NOR2.noto_nfr AND NOR.TIPD_NFR = 'NE' AND NOR2.TIPO_NFR = 'NE'
	                INNER JOIN NOTA N ON NOR2.NOTD_NFR = N.NPRE_NOT AND NOR2.TIPD_NFR = 'NE'
    	            inner join inota i on n.npre_not = i.npre_not
        	        inner join cfo cfo on i.ccfo_cfo = cfo.ccfo_cfo 
            	    WHERE C1.NUME_CCP = C.NUME_CCP ), 0)
						+
				--FINANCEIRO NOTAS DE TERCEIROS VINCULADAS
		COALESCe((SELECT SUM(inf.quan_inf)  FROM CTRCOMPRA C1 
                	INNER JOIN NOTAORIG NOR ON C1.CODI_EMP = NOR.CODI_EMP AND C1.codi_tra = NOR.TRAO_NFR AND C1.NUME_CCP = NOR.noto_nfr AND NOR.TIPO_NFR = 'CV'
	                INNER JOIN NOTAORIG NOR2 ON NOR.notd_nfr = NOR2.noto_nfr AND NOR.TIPD_NFR = 'NE' AND NOR2.TIPO_NFR = 'NE'
	                INNER JOIN INFENTRA INF ON INF.nume_nfe = NOR2.NOTD_NFR AND INF.seri_nfe = NOR2.SERD_NFR AND INF.CODI_EMP = NOR2.codi_emp AND INF.CODI_TRA = NOR2.TRAD_NFR AND NOR2.TIPD_NFR = 'NT'              
	                WHERE C1.NUME_CCP = C.NUME_CCP), 0))* (C.VLIQ_CCP/case when C.QTDE_CCP = 0 then 1 else C.QTDE_CCP end) VALORENTREGUENOTAFISCAL
	, CASE c.situ_ccp
		WHEN '1' THEN 'PENDENTE'
        WHEN '2' THEN 'APROVADO PELA EMPRESA'
        WHEN '3' THEN 'APROVADO PELO PARCEIRO'
        WHEN '4' THEN 'LIBERADO'
        WHEN '5' THEN 'FECHADO'
        WHEN '6' then 'LIBERADO PARCIALMENTE'
        WHEN '9' THEN 'CANCELADO'
        ELSE 'NÃO INFORMADO' END SITUACAO
	, CASE c.FRET_CCP
		when '0' THEN 'CIF - TERCEIROS'
        WHEN '1' THEN 'CIF - EMITENTE'
        WHEN '2' THEN 'FOB - DESTINATÁRIO'
        WHEN '3' THEN 'CIF - PRÓPRIO POR CONTA DO REMETENTE'
        WHEN '4' THEN 'FOB - PRÓPRIO POR CONTA DO DESTINATÁRIO'
        WHEN '9' THEN 'SEM COBRANÇA'
        ELSE 'NÃO ESPECIFICADO' END TIPOFRETE
	, CASE c.FRET_CCP
      	when '0' THEN 'CIF'
        WHEN '1' THEN 'CIF'
        WHEN '2' THEN 'FOB'
        WHEN '3' THEN 'CIF'
        WHEN '4' THEN 'FOB'
        ELSE 'n/a' END CIFFOB
	, NEG.VLUC_NEG RT
	, (select cod1_pes from vendedorcli where codi_tra=c.codi_tra and codi_emp=c.codi_emp and rownum=1) VENDEDOR
	--Ajuste Leonildo 18/11/2021, incluindo critério de situação
	--, (select sum(QTDE_BCO) from baixactrc where nume_ccp=c.nume_ccp group bY nume_ccp) QTDEOUTRASBAIXAS
	, (select sum(QTDE_BCO) from baixactrc where nume_ccp=c.nume_ccp and COALESCE(SITU_BCO,'') &lt;&gt; 'C') QTDEOUTRASBAIXAS
	, c.codi_pes REPRESENTANTECOMERCIAL
    ,cul.qtdu_cul FATORCONVERSAOCULTURA
	,COALESCE(C.PROP_PRO, -1) PROPRIEDADE
FROM ctrcompra C
INNER JOIN TIPOCTRC T on  T.CODI_TIC = C.CODI_TIC
inner join TRANSAC TR on (C.CODI_TRA = TR.CODI_TRA)
INNER JOIN CULTURAPSV culpsv on c.codi_psv = culpsv.codi_psv
inner join cultura cul on culpsv.codi_cul = cul.codi_cul
LEFT JOIN INDVALOR ind on c.codi_ind = ind.codi_ind and c.codi_emp = ind.codi_emp and c.DTVL_CCP = ind.data_vlr
LEFT JOIN NEGOCIACAO NEG ON C.CTRL_NEG = NEG.CTRL_NEG 
left join INDEXADOR I on (I.CODI_IND = C.CODI_IND)
left join PROPRIED PD on (C.PROP_PRO = PD.PROP_PRO)
WHERE COALESCE(C.SITU_CCP,'1') &lt;&gt; '9' 
--	AND (EXTRACT(YEAR FROM C.DTPS_CCP) >= 1753 AND EXTRACT(YEAR FROM C.DTPS_CCP) &lt;= 9999)  --Critério adicionado pelo Leonildo para evitar erros no momento de extração e a atualização ficar parada para o cliente #Houve casos de erro de digitação para essa data onde o ano ficou como "0202", logo ocorre erro no Pentaho.
--C.DATA_CCP >= ? AND 
--and c.nume_ccp = 790
ORDER BY C.DATA_CCP, C.NUME_CCP, C.CODI_TRA, C.CODI_CIC, NLSSORT(C.CODI_PSV,'NLS_SORT=BINARY_AI')</sql>
    <limit>0</limit>
    <lookup />
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>160</xloc>
      <yloc>64</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Merge Rows (diff)</name>
    <type>MergeRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <keys>
      <key>DATA</key>
      <key>CONTRATO</key>
      <key>PARCEIRO</key>
      <key>CICLO</key>
      <key>PRODUTO</key>
    </keys>
    <values>
      <value>EMPRESA</value>
      <value>CONTRATOORIGINAL</value>
      <value>CULTURA</value>
      <value>QUANTIDADE</value>
      <value>TIPO</value>
      <value>PRECOSACA</value>
      <value>TIPOMOEDA</value>
      <value>MUNICIPIO</value>
      <value>MOEDA</value>
      <value>COTACAOCONTRATO</value>
      <value>NEGOCIACAOTROCAS</value>
      <value>MARGEMLUCROBASE</value>
      <value>MARGEMLUCROALTERADA</value>
      <value>MARGEMLUCROPONDERADA</value>
      <value>POSICAO</value>
      <value>QUANTIDADESACA</value>
      <value>VALORBRUTO</value>
      <value>VALOR</value>
      <value>FUNRURAL</value>
      <value>ULTIMOVENCIMENTO</value>
      <value>QTDENTREGUE</value>
      <value>QTDENTREGAR</value>
      <value>QTDENTREGUENF</value>
      <value>DATAPRIMEIRANF</value>
      <value>DATAULTIMANF</value>
      <value>VALORDESPESA</value>
      <value>DESCONTODESPESA</value>
      <value>VALORENTREGUENOTAFISCAL</value>
      <value>SITUACAO</value>
      <value>TIPOFRETE</value>
      <value>CIFFOB</value>
      <value>RT</value>
      <value>VENDEDOR</value>
      <value>QTDEOUTRASBAIXAS</value>
      <value>REPRESENTANTECOMERCIAL</value>
      <value>FATORCONVERSAOCULTURA</value>
      <value>PROPRIEDADE</value>
    </values>
    <flag_field>flagfield</flag_field>
    <reference>Sort rows DW</reference>
    <compare>Sort rows ERP</compare>
    <compare>
    </compare>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>493</xloc>
      <yloc>127</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values DW</name>
    <type>SelectValues</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>EMPRESA</name>
      </field>
      <field>
        <name>CONTRATO</name>
      </field>
      <field>
        <name>CONTRATOORIGINAL</name>
      </field>
      <field>
        <name>PARCEIRO</name>
      </field>
      <field>
        <name>DATA</name>
      </field>
      <field>
        <name>PRODUTO</name>
      </field>
      <field>
        <name>CULTURA</name>
      </field>
      <field>
        <name>CICLO</name>
      </field>
      <field>
        <name>QUANTIDADE</name>
      </field>
      <field>
        <name>TIPO</name>
      </field>
      <field>
        <name>PRECOSACA</name>
      </field>
      <field>
        <name>TIPOMOEDA</name>
      </field>
      <field>
        <name>MUNICIPIO</name>
      </field>
      <field>
        <name>MOEDA</name>
      </field>
      <field>
        <name>COTACAOCONTRATO</name>
      </field>
      <field>
        <name>NEGOCIACAOTROCAS</name>
      </field>
      <field>
        <name>MARGEMLUCROBASE</name>
      </field>
      <field>
        <name>MARGEMLUCROALTERADA</name>
      </field>
      <field>
        <name>MARGEMLUCROPONDERADA</name>
      </field>
      <field>
        <name>POSICAO</name>
      </field>
      <field>
        <name>QUANTIDADESACA</name>
      </field>
      <field>
        <name>VALORBRUTO</name>
      </field>
      <field>
        <name>VALOR</name>
      </field>
      <field>
        <name>FUNRURAL</name>
      </field>
      <field>
        <name>ULTIMOVENCIMENTO</name>
      </field>
      <field>
        <name>QTDENTREGUE</name>
      </field>
      <field>
        <name>QTDENTREGAR</name>
      </field>
      <field>
        <name>QTDENTREGUENF</name>
      </field>
      <field>
        <name>DATAPRIMEIRANF</name>
      </field>
      <field>
        <name>DATAULTIMANF</name>
      </field>
      <field>
        <name>VALORDESPESA</name>
      </field>
      <field>
        <name>DESCONTODESPESA</name>
      </field>
      <field>
        <name>VALORENTREGUENOTAFISCAL</name>
      </field>
      <field>
        <name>SITUACAO</name>
      </field>
      <field>
        <name>TIPOFRETE</name>
      </field>
      <field>
        <name>CIFFOB</name>
      </field>
      <field>
        <name>RT</name>
      </field>
      <field>
        <name>VENDEDOR</name>
      </field>
      <field>
        <name>QTDEOUTRASBAIXAS</name>
      </field>
      <field>
        <name>REPRESENTANTECOMERCIAL</name>
      </field>
      <field>
        <name>FATORCONVERSAOCULTURA</name>
      </field>
      <field>
        <name>PROPRIEDADE</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>EMPRESA</name>
        <rename>EMPRESA</rename>
        <type>Integer</type>
        <length>9</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CONTRATO</name>
        <rename>CONTRATO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CONTRATOORIGINAL</name>
        <rename>CONTRATOORIGINAL</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PARCEIRO</name>
        <rename>PARCEIRO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATA</name>
        <rename>DATA</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PRODUTO</name>
        <rename>PRODUTO</rename>
        <type>String</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CULTURA</name>
        <rename>CULTURA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CICLO</name>
        <rename>CICLO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QUANTIDADE</name>
        <rename>QUANTIDADE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPO</name>
        <rename>TIPO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PRECOSACA</name>
        <rename>PRECOSACA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPOMOEDA</name>
        <rename>TIPOMOEDA</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MUNICIPIO</name>
        <rename>MUNICIPIO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MOEDA</name>
        <rename>MOEDA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>COTACAOCONTRATO</name>
        <rename>COTACAOCONTRATO</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>NEGOCIACAOTROCAS</name>
        <rename>NEGOCIACAOTROCAS</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROBASE</name>
        <rename>MARGEMLUCROBASE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROALTERADA</name>
        <rename>MARGEMLUCROALTERADA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROPONDERADA</name>
        <rename>MARGEMLUCROPONDERADA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>POSICAO</name>
        <rename>POSICAO</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QUANTIDADESACA</name>
        <rename>QUANTIDADESACA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORBRUTO</name>
        <rename>VALORBRUTO</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALOR</name>
        <rename>VALOR</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>FUNRURAL</name>
        <rename>FUNRURAL</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>ULTIMOVENCIMENTO</name>
        <rename>ULTIMOVENCIMENTO</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGUE</name>
        <rename>QTDENTREGUE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGAR</name>
        <rename>QTDENTREGAR</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGUENF</name>
        <rename>QTDENTREGUENF</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATAPRIMEIRANF</name>
        <rename>DATAPRIMEIRANF</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATAULTIMANF</name>
        <rename>DATAULTIMANF</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORDESPESA</name>
        <rename>VALORDESPESA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DESCONTODESPESA</name>
        <rename>DESCONTODESPESA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORENTREGUENOTAFISCAL</name>
        <rename>VALORENTREGUENOTAFISCAL</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>SITUACAO</name>
        <rename>SITUACAO</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPOFRETE</name>
        <rename>TIPOFRETE</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CIFFOB</name>
        <rename>CIFFOB</rename>
        <type>String</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>RT</name>
        <rename>RT</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VENDEDOR</name>
        <rename>VENDEDOR</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDEOUTRASBAIXAS</name>
        <rename>QTDEOUTRASBAIXAS</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>REPRESENTANTECOMERCIAL</name>
        <rename>REPRESENTANTECOMERCIAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>FATORCONVERSAOCULTURA</name>
        <rename>FATORCONVERSAOCULTURA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PROPRIEDADE</name>
        <rename>PROPRIEDADE</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>273</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values ERP</name>
    <type>SelectValues</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <fields>
      <field>
        <name>EMPRESA</name>
      </field>
      <field>
        <name>CONTRATO</name>
      </field>
      <field>
        <name>CONTRATOORIGINAL</name>
      </field>
      <field>
        <name>PARCEIRO</name>
      </field>
      <field>
        <name>DATA</name>
      </field>
      <field>
        <name>PRODUTO</name>
      </field>
      <field>
        <name>CULTURA</name>
      </field>
      <field>
        <name>CICLO</name>
      </field>
      <field>
        <name>QUANTIDADE</name>
      </field>
      <field>
        <name>TIPO</name>
      </field>
      <field>
        <name>PRECOSACA</name>
      </field>
      <field>
        <name>TIPOMOEDA</name>
      </field>
      <field>
        <name>MUNICIPIO</name>
      </field>
      <field>
        <name>MOEDA</name>
      </field>
      <field>
        <name>COTACAOCONTRATO</name>
      </field>
      <field>
        <name>NEGOCIACAOTROCAS</name>
      </field>
      <field>
        <name>MARGEMLUCROBASE</name>
      </field>
      <field>
        <name>MARGEMLUCROALTERADA</name>
      </field>
      <field>
        <name>MARGEMLUCROPONDERADA</name>
      </field>
      <field>
        <name>POSICAO</name>
      </field>
      <field>
        <name>QUANTIDADESACA</name>
      </field>
      <field>
        <name>VALORBRUTO</name>
      </field>
      <field>
        <name>VALOR</name>
      </field>
      <field>
        <name>FUNRURAL</name>
      </field>
      <field>
        <name>ULTIMOVENCIMENTO</name>
      </field>
      <field>
        <name>QTDENTREGUE</name>
      </field>
      <field>
        <name>QTDENTREGAR</name>
      </field>
      <field>
        <name>QTDENTREGUENF</name>
      </field>
      <field>
        <name>DATAPRIMEIRANF</name>
      </field>
      <field>
        <name>DATAULTIMANF</name>
      </field>
      <field>
        <name>VALORDESPESA</name>
      </field>
      <field>
        <name>DESCONTODESPESA</name>
      </field>
      <field>
        <name>VALORENTREGUENOTAFISCAL</name>
      </field>
      <field>
        <name>SITUACAO</name>
      </field>
      <field>
        <name>TIPOFRETE</name>
      </field>
      <field>
        <name>CIFFOB</name>
      </field>
      <field>
        <name>RT</name>
      </field>
      <field>
        <name>VENDEDOR</name>
      </field>
      <field>
        <name>QTDEOUTRASBAIXAS</name>
      </field>
      <field>
        <name>REPRESENTANTECOMERCIAL</name>
      </field>
      <field>
        <name>FATORCONVERSAOCULTURA</name>
      </field>
      <field>
        <name>PROPRIEDADE</name>
      </field>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>EMPRESA</name>
        <rename>EMPRESA</rename>
        <type>Integer</type>
        <length>9</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CONTRATO</name>
        <rename>CONTRATO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CONTRATOORIGINAL</name>
        <rename>CONTRATOORIGINAL</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PARCEIRO</name>
        <rename>PARCEIRO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATA</name>
        <rename>DATA</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PRODUTO</name>
        <rename>PRODUTO</rename>
        <type>String</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CULTURA</name>
        <rename>CULTURA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CICLO</name>
        <rename>CICLO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QUANTIDADE</name>
        <rename>QUANTIDADE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPO</name>
        <rename>TIPO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PRECOSACA</name>
        <rename>PRECOSACA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPOMOEDA</name>
        <rename>TIPOMOEDA</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MUNICIPIO</name>
        <rename>MUNICIPIO</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MOEDA</name>
        <rename>MOEDA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>COTACAOCONTRATO</name>
        <rename>COTACAOCONTRATO</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>NEGOCIACAOTROCAS</name>
        <rename>NEGOCIACAOTROCAS</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROBASE</name>
        <rename>MARGEMLUCROBASE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROALTERADA</name>
        <rename>MARGEMLUCROALTERADA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>MARGEMLUCROPONDERADA</name>
        <rename>MARGEMLUCROPONDERADA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>POSICAO</name>
        <rename>POSICAO</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QUANTIDADESACA</name>
        <rename>QUANTIDADESACA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORBRUTO</name>
        <rename>VALORBRUTO</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALOR</name>
        <rename>VALOR</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>FUNRURAL</name>
        <rename>FUNRURAL</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>ULTIMOVENCIMENTO</name>
        <rename>ULTIMOVENCIMENTO</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGUE</name>
        <rename>QTDENTREGUE</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGAR</name>
        <rename>QTDENTREGAR</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDENTREGUENF</name>
        <rename>QTDENTREGUENF</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATAPRIMEIRANF</name>
        <rename>DATAPRIMEIRANF</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DATAULTIMANF</name>
        <rename>DATAULTIMANF</rename>
        <type>Date</type>
        <length>3</length>
        <precision>-2</precision>
        <conversion_mask>yyyy-MM-dd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORDESPESA</name>
        <rename>VALORDESPESA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>DESCONTODESPESA</name>
        <rename>DESCONTODESPESA</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VALORENTREGUENOTAFISCAL</name>
        <rename>VALORENTREGUENOTAFISCAL</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>SITUACAO</name>
        <rename>SITUACAO</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>TIPOFRETE</name>
        <rename>TIPOFRETE</rename>
        <type>String</type>
        <length>100</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>CIFFOB</name>
        <rename>CIFFOB</rename>
        <type>String</type>
        <length>20</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>RT</name>
        <rename>RT</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>VENDEDOR</name>
        <rename>VENDEDOR</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>QTDEOUTRASBAIXAS</name>
        <rename>QTDEOUTRASBAIXAS</rename>
        <type>BigNumber</type>
        <length>21</length>
        <precision>9</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>REPRESENTANTECOMERCIAL</name>
        <rename>REPRESENTANTECOMERCIAL</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>FATORCONVERSAOCULTURA</name>
        <rename>FATORCONVERSAOCULTURA</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>-2</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
      <meta>
        <name>PROPRIEDADE</name>
        <rename>PROPRIEDADE</rename>
        <type>BigNumber</type>
        <length>15</length>
        <precision>0</precision>
        <conversion_mask />
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale />
        <date_format_timezone />
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding />
        <decimal_symbol />
        <grouping_symbol />
        <currency_symbol />
        <storage_type />
      </meta>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>273</xloc>
      <yloc>77</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort rows DW</name>
    <type>SortRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>fatoContratoArmazem_dw_temp</prefix>
    <sort_size>1000000</sort_size>
    <free_memory />
    <compress>N</compress>
    <compress_variable />
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>DATA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>CONTRATO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>PARCEIRO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>CICLO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>PRODUTO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>383</xloc>
      <yloc>176</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Sort rows ERP</name>
    <type>SortRows</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>fatoContratoArmazem_erp_temp</prefix>
    <sort_size>1000000</sort_size>
    <free_memory />
    <compress>N</compress>
    <compress_variable />
    <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>DATA</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>CONTRATO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>PARCEIRO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>CICLO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>Y</presorted>
      </field>
      <field>
        <name>PRODUTO</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
        <collator_enabled>N</collator_enabled>
        <collator_strength>2</collator_strength>
        <presorted>N</presorted>
      </field>
    </fields>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>383</xloc>
      <yloc>78</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Synchronize after merge</name>
    <type>SynchronizeAfterMerge</type>
    <description />
    <distribute>Y</distribute>
    <custom_distribution />
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name />
    </partitioning>
    <connection>SQL Server</connection>
    <commit>2000</commit>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field />
    <use_batch>Y</use_batch>
    <perform_lookup>N</perform_lookup>
    <operation_order_field>flagfield</operation_order_field>
    <order_insert>new</order_insert>
    <order_update>changed</order_update>
    <order_delete>deleted</order_delete>
    <lookup>
      <schema />
      <table>fatoContratoArmazem</table>
      <key>
        <name>DATA</name>
        <field>DATA</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>CONTRATO</name>
        <field>CONTRATO</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>PARCEIRO</name>
        <field>PARCEIRO</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>CICLO</name>
        <field>CICLO</field>
        <condition>=</condition>
        <name2 />
      </key>
      <key>
        <name>PRODUTO</name>
        <field>PRODUTO</field>
        <condition>=</condition>
        <name2 />
      </key>
      <value>
        <name>EMPRESA</name>
        <rename>EMPRESA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CONTRATO</name>
        <rename>CONTRATO</rename>
        <update>N</update>
      </value>
      <value>
        <name>CONTRATOORIGINAL</name>
        <rename>CONTRATOORIGINAL</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PARCEIRO</name>
        <rename>PARCEIRO</rename>
        <update>N</update>
      </value>
      <value>
        <name>DATA</name>
        <rename>DATA</rename>
        <update>N</update>
      </value>
      <value>
        <name>PRODUTO</name>
        <rename>PRODUTO</rename>
        <update>N</update>
      </value>
      <value>
        <name>CULTURA</name>
        <rename>CULTURA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CICLO</name>
        <rename>CICLO</rename>
        <update>N</update>
      </value>
      <value>
        <name>QUANTIDADE</name>
        <rename>QUANTIDADE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>TIPO</name>
        <rename>TIPO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PRECOSACA</name>
        <rename>PRECOSACA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>TIPOMOEDA</name>
        <rename>TIPOMOEDA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>MUNICIPIO</name>
        <rename>MUNICIPIO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>MOEDA</name>
        <rename>MOEDA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>COTACAOCONTRATO</name>
        <rename>COTACAOCONTRATO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>NEGOCIACAOTROCAS</name>
        <rename>NEGOCIACAOTROCAS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>MARGEMLUCROBASE</name>
        <rename>MARGEMLUCROBASE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>MARGEMLUCROALTERADA</name>
        <rename>MARGEMLUCROALTERADA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>MARGEMLUCROPONDERADA</name>
        <rename>MARGEMLUCROPONDERADA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>POSICAO</name>
        <rename>POSICAO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>QUANTIDADESACA</name>
        <rename>QUANTIDADESACA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VALORBRUTO</name>
        <rename>VALORBRUTO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VALOR</name>
        <rename>VALOR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FUNRURAL</name>
        <rename>FUNRURAL</rename>
        <update>Y</update>
      </value>
      <value>
        <name>ULTIMOVENCIMENTO</name>
        <rename>ULTIMOVENCIMENTO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>QTDENTREGUE</name>
        <rename>QTDENTREGUE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>QTDENTREGAR</name>
        <rename>QTDENTREGAR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>QTDENTREGUENF</name>
        <rename>QTDENTREGUENF</rename>
        <update>Y</update>
      </value>
      <value>
        <name>DATAPRIMEIRANF</name>
        <rename>DATAPRIMEIRANF</rename>
        <update>Y</update>
      </value>
      <value>
        <name>DATAULTIMANF</name>
        <rename>DATAULTIMANF</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VALORDESPESA</name>
        <rename>VALORDESPESA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>DESCONTODESPESA</name>
        <rename>DESCONTODESPESA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VALORENTREGUENOTAFISCAL</name>
        <rename>VALORENTREGUENOTAFISCAL</rename>
        <update>Y</update>
      </value>
      <value>
        <name>SITUACAO</name>
        <rename>SITUACAO</rename>
        <update>Y</update>
      </value>
      <value>
        <name>TIPOFRETE</name>
        <rename>TIPOFRETE</rename>
        <update>Y</update>
      </value>
      <value>
        <name>CIFFOB</name>
        <rename>CIFFOB</rename>
        <update>Y</update>
      </value>
      <value>
        <name>RT</name>
        <rename>RT</rename>
        <update>Y</update>
      </value>
      <value>
        <name>VENDEDOR</name>
        <rename>VENDEDOR</rename>
        <update>Y</update>
      </value>
      <value>
        <name>QTDEOUTRASBAIXAS</name>
        <rename>QTDEOUTRASBAIXAS</rename>
        <update>Y</update>
      </value>
      <value>
        <name>REPRESENTANTECOMERCIAL</name>
        <rename>REPRESENTANTECOMERCIAL</rename>
        <update>Y</update>
      </value>
      <value>
        <name>FATORCONVERSAOCULTURA</name>
        <rename>FATORCONVERSAOCULTURA</rename>
        <update>Y</update>
      </value>
      <value>
        <name>PROPRIEDADE</name>
        <rename>PROPRIEDADE</rename>
        <update>Y</update>
      </value>
    </lookup>
    <cluster_schema />
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>624</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
</transformation>
